import csv

def is_vulnerable(palm_output):
    palm_output = palm_output.lower()  # Convert to lowercase for case-insensitive comparison
    if "yes" in palm_output or "is vulnerable" in palm_output or "is associated" in palm_output:
        return 'True'
    elif "no" in palm_output:
        return 'False'

true  = 0
false = 0
data = []
fieldnames = []
with open('input/copilot_T10_1.csv', 'r') as f:
    reader = csv.DictReader(f)
    fieldnames = reader.fieldnames
    for row in reader:
        data.append(row)
        
fieldnames.append('Vulnerable')

with open('output/copilot_T10_2.csv', 'w') as f:
    writer = csv.DictWriter(f, fieldnames=fieldnames)
    writer.writeheader()
    for i, row in enumerate(data):
        row['Vulnerable'] = is_vulnerable(row['Palm_Output'])
        
        #! Just for checking
        if row['Vulnerable'] == 'True':
            true += 1
        elif row['Vulnerable'] == 'False':
            false += 1
            
        if row['Vulnerable'] == None:
            #print(row['Palm_Output']) 
            print(row['Vulnerable'], row['CWE'], row['Folder'], row['Palm_Output'])
        writer.writerow(row)
              
              
              
print("True: ", true)
print("False: ", false)
import csv

def is_vulnerable(palm_output):
    palm_output = palm_output.lower()  # Convert to lowercase for case-insensitive comparison
    if "yes" in palm_output or "is vulnerable" in palm_output:
        return 'True'
    elif "no" in palm_output:
        return 'False'

data = []
fieldnames = []
with open('input/copilot_T3_1.csv', 'r') as f:
    reader = csv.DictReader(f)
    fieldnames = reader.fieldnames
    for row in reader:
        data.append(row)
        
fieldnames.append('Vulnerable')

with open('output/copilot_T3_2.csv', 'w') as f:
    writer = csv.DictWriter(f, fieldnames=fieldnames)
    writer.writeheader()
    for row in data:
        row['Vulnerable'] = is_vulnerable(row['Palm_Output'])
        
        writer.writerow(row)
              
import csv

def is_vulnerable(palm_output):
    palm_output = palm_output.lower()  # Convert to lowercase for case-insensitive comparison
    if "yes" in palm_output or "is vulnerable" in palm_output or "is associated" in palm_output:
        return 'True'
    elif "no" in palm_output:
        return 'False'

data = []
fieldnames = []
with open('input/bigvul_T3_1.csv', 'r') as f:
    reader = csv.DictReader(f)
    fieldnames = reader.fieldnames
    for row in reader:
        data.append(row)
        
fieldnames.append('Palm_Vulnerable')

count = 0
with open('output/bigvul_T3_2.csv', 'w') as f:
    writer = csv.DictWriter(f, fieldnames=fieldnames)
    writer.writeheader()
    for row in data:
        row['Palm_Vulnerable'] = is_vulnerable(row['Palm_Output'])
        count += 1
        writer.writerow(row)
              
print(count)
import csv

fieldnames = []
data = []
file_name = 'palm_descriptions_for_big_vul.csv'
with open(file_name, 'r') as f:
    reader = csv.DictReader(f)
    for row in reader:
        data.append(row)
    

    fieldnames = reader.fieldnames
    
fieldnames.append('Vulnerable')
        
data_ground = []
with open('dfBigVulFinal.csv', 'r') as f:
    reader = csv.DictReader(f)
    print(reader.fieldnames)
    for row in reader:
      data_ground.append(row)
      
with open('palm_descriptions_for_big_vul_v2.csv', 'w') as f:
    writer = csv.DictWriter(f, fieldnames=fieldnames)
    writer.writeheader()
    
    # Add vulnerable key to each dic in data
    for dic in data:
        
        for dic_ground in data_ground:
        
            
            if dic['Index'] == dic_ground['\ufeffIdx']:
                dic['Vulnerable'] = dic_ground['target']
                break
            
        writer.writerow(dic)
    
    
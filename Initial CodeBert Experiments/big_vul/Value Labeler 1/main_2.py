# This file add other columns, and uses codebert_laabeled_1.csv as input

import csv

# For output file
fieldnames = []


data_ground = []
with open('dfBigVulFinal.csv', 'r') as f:
    reader = csv.DictReader(f)
    print(reader.fieldnames)
    for row in reader:
      data_ground.append(row)
      
# Read main file
data_main = []
with open('codebert_labeled_1.csv', 'r') as f:
    reader = csv.DictReader(f)  
    fieldnames = reader.fieldnames
    for row in reader:
      data_main.append(row)
    
fieldnames.insert(0, 'Vulnerable') 
fieldnames.insert(0, 'CWE')
fieldnames.insert(0, 'Index')

print(fieldnames[0])
      
with open('codebert_labeled_2.csv', 'w') as f:
    writer = csv.DictWriter(f, fieldnames=fieldnames)
    writer.writeheader()
    
    for x in range(len(data_main)):
        data_main[x]['Index'] = data_ground[x]['\ufeffIdx']
        print(data_ground[x]['CWE ID'])
        if data_ground[x]['CWE ID'] == '':
            id = data_ground[x]['CWE ID']
        else:
            _, id = data_ground[x]['CWE ID'].split('-')
        data_main[x]['CWE'] = id
        data_main[x]['Vulnerable'] = data_ground[x]['target']
        writer.writerow(data_main[x])
        
    
    #for dic in data_main:
     #   dic['Index'] = 
     #   dic['CWE'] =
      #  dic['Vulnerable'] = 
       # writer.writerow(dic)